<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Fixtures</title>
<link rel="stylesheet" href="../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="../../index.html" title="Boost.Test">
<link rel="up" href="../tests_organization.html" title="Test organization using the Unit Test Framework">
<link rel="prev" href="test_organization_test_suite.html" title="Test suite">
<link rel="next" href="../testing_tools.html" title="The Unit Test Framework testing tools">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="test_organization_test_suite.html"><img src="../../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../tests_organization.html"><img src="../../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="../testing_tools.html"><img src="../../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_test.tests_organization.fixtures"></a><a class="link" href="fixtures.html" title="Fixtures">Fixtures</a>
</h3></div></div></div>
<p>
        In general terms a test fixture or test context is the collection of one
        or more of the following items, required to perform the test:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            preconditions
          </li>
<li class="listitem">
            particular states of tested unites
          </li>
<li class="listitem">
            necessary cleanup procedures
          </li>
</ul></div>
<p>
        Though these tasks are encountered in many if not all test cases, what makes
        a test fixture different is repetition. Where a normal test case implementation
        does all preparatory and cleanup work itself, a test fixture allows this
        to be implemented in a separate reusable unit.
      </p>
<p>
        With introduction of e<span class="bold"><strong>X</strong></span>treme <span class="bold"><strong>P</strong></span>rogramming
        (XP), the testing style, that require test setup/cleanup repetition, is becoming
        more and more popular. Single XP adopted test modules may contain hundreds
        of single assertion test cases, many requiring very similar test setup/cleanup.
        This is the problem that the test fixture is designed to solve.
      </p>
<p>
        In practice a test fixture usually is a combination of setup and teardown
        functions, associated with test case. The former serves the purposes of test
        setup; the later is dedicated to the cleanup tasks. Ideally it's preferable
        that a test module author is able to define variables used in fixtures on
        the stack and the same time is able to refer to them directly in test case.
      </p>
<p>
        It's important to understand that C++ provides a way to implement a straightforward
        test fixture solution that almost satisfies our requirements without any
        extra support from the test framework. This may explain why test fixtures
        support was introduced in the <span class="emphasis"><em>Unit Test Framework</em></span> somewhat
        late in its life cycle. Here is how simple test module with such a fixture
        may look like:
      </p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">MyFixture</span> <span class="special">{</span>
  <span class="identifier">MyFixture</span><span class="special">()</span>   <span class="special">{</span> <span class="identifier">i</span> <span class="special">=</span> <span class="keyword">new</span> <span class="keyword">int</span><span class="special">;</span> <span class="special">*</span><span class="identifier">i</span> <span class="special">=</span> <span class="number">0</span> <span class="special">}</span>
  <span class="special">~</span><span class="identifier">MyFixture</span><span class="special">()</span>  <span class="special">{</span> <span class="keyword">delete</span> <span class="identifier">i</span><span class="special">;</span> <span class="special">}</span>

  <span class="keyword">int</span><span class="special">*</span> <span class="identifier">i</span><span class="special">;</span>
<span class="special">};</span>

<a class="link" href="test_cases.html#ref_BOOST_AUTO_TEST_CASE"><code class="computeroutput"><span class="identifier">BOOST_AUTO_TEST_CASE</span></code></a><span class="special">(</span> <span class="identifier">test_case1</span> <span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">MyFixture</span> <span class="identifier">f</span><span class="special">;</span>
  <span class="comment">// do something involving f.i</span>
<span class="special">}</span>

<a class="link" href="test_cases.html#ref_BOOST_AUTO_TEST_CASE"><code class="computeroutput"><span class="identifier">BOOST_AUTO_TEST_CASE</span></code></a><span class="special">(</span> <span class="identifier">test_case2</span> <span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">MyFixture</span> <span class="identifier">f</span><span class="special">;</span>
  <span class="comment">// do something involving f.i</span>
<span class="special">}</span>
</pre>
<p>
        This is a generic solution that can be used to implement any kind of shared
        setup or cleanup procedure. Still there are several more or less minor practical
        issues with this pure C++ based fixtures solution:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            We need to add a fixture declaration statement into each test case manually.
          </li>
<li class="listitem">
            Objects defined in fixture are references with <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">fixture</span><span class="special">-</span><span class="identifier">instance</span><span class="special">-</span><span class="identifier">name</span><span class="special">&gt;</span></code>
            prefix.
          </li>
<li class="listitem">
            There is no place to execute a <span class="emphasis"><em>global</em></span> fixture, which
            performs <span class="emphasis"><em>global</em></span> setup/cleanup procedures before
            and after testing.
          </li>
</ul></div>
<p>
        While there is little the <span class="emphasis"><em>Unit Test Framework</em></span> can do
        to address these issues for manually registered test units, it's possible
        to resolve them for test units that are automatically registered. To do this
        the <span class="emphasis"><em>Unit Test Framework</em></span> defines a <a class="link" href="fixtures.html#fixtures_generic">generic
        fixture model</a> - fixed interfaces that both setup and teardown fixture
        functions should comply to. Based on the generic fixture model, the <span class="emphasis"><em>Unit
        Test Framework</em></span> presents solution for the following tasks:
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            per test case fixture automation
          </li>
<li class="listitem">
            shared test suite level fixture
          </li>
<li class="listitem">
            <span class="emphasis"><em>global</em></span> fixture support
          </li>
</ul></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_test.tests_organization.fixtures.generic_fixture_model"></a><a name="fixtures_generic"></a><a class="link" href="fixtures.html#boost_test.tests_organization.fixtures.generic_fixture_model" title="Generic fixture model">Generic
        fixture model</a>
</h4></div></div></div>
<p>
          The <span class="emphasis"><em>Unit Test Framework</em></span> defines the generic fixture
          model as follows:
        </p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="special">&lt;</span><span class="identifier">fixture</span><span class="special">-</span><span class="identifier">name</span><span class="special">&gt;{</span>
  <span class="special">&lt;</span><span class="identifier">fixture</span><span class="special">-</span><span class="identifier">name</span><span class="special">&gt;();</span>      <span class="comment">// setup function</span>
  <span class="special">~&lt;</span><span class="identifier">fixture</span><span class="special">-</span><span class="identifier">name</span><span class="special">&gt;();</span>     <span class="comment">// teardown function</span>
<span class="special">};</span>
</pre>
<p>
          In other words a fixture is expected to be implemented as a class where
          the class constructor serves as a setup method and class destructor serves
          as teardown method. The <span class="emphasis"><em>Unit Test Framework</em></span> opted
          to avoid explicit names in fixture interface for setup and teardown methods,
          since is considered most natural in C++ for tasks similar to RAII and coincides
          with the pure C++ solution discusses earlier.
        </p>
<div class="caution"><table border="0" summary="Caution">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="../../../../../../../doc/src/images/caution.png"></td>
<th align="left">Caution</th>
</tr>
<tr><td align="left" valign="top"><p>
            The above interface prevents you to report errors in the teardown procedure
            using an exception. It does make sense though: if somehow more than one
            fixture is assigned to a test unit, you want all teardown procedures
            to run, even if some may experience problems.
          </p></td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_test.tests_organization.fixtures.per_test_case_fixture"></a><a name="ref_fixture_test_case"></a><a class="link" href="fixtures.html#boost_test.tests_organization.fixtures.per_test_case_fixture" title="Per test case fixture">Per
        test case fixture</a>
</h4></div></div></div>
<p>
          To automate the task of assigning a fixture for the test case, for test
          case creation use the macro <a class="link" href="fixtures.html#ref_fixture_test_case"><code class="computeroutput"><span class="identifier">BOOST_FIXTURE_TEST_CASE</span></code></a> in place
          of the macro <a class="link" href="test_cases.html#ref_BOOST_AUTO_TEST_CASE"><code class="computeroutput"><span class="identifier">BOOST_AUTO_TEST_CASE</span></code></a>:
        </p>
<pre class="programlisting"><span class="identifier">BOOST_FIXTURE_TEST_CASE</span><span class="special">(</span><span class="identifier">test_case_name</span><span class="special">,</span> <span class="identifier">fixture_name</span><span class="special">);</span>
</pre>
<p>
          The only difference from the macro <a class="link" href="test_cases.html#ref_BOOST_AUTO_TEST_CASE"><code class="computeroutput"><span class="identifier">BOOST_AUTO_TEST_CASE</span></code></a> is the presence
          of an extra argument - fixture name. Unlike the pure C++ solution you have
          direct access to the public and protected members of the fixture, though
          you still need to refer to the fixture name in every test case.
        </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            You can't access private members of fixture, but then why would you make
            anything private?
          </p></td></tr>
</table></div>
<h6>
<a name="boost_test.tests_organization.fixtures.per_test_case_fixture.h0"></a>
          <span><a name="boost_test.tests_organization.fixtures.per_test_case_fixture.example_descr"></a></span><a class="link" href="fixtures.html#boost_test.tests_organization.fixtures.per_test_case_fixture.example_descr">Example:
          Per test case fixture</a>
        </h6>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                  <p>
                    Code
                  </p>
                </th>
<th>
                  <p>
                    Output
                  </p>
                </th>
</tr></thead>
<tbody><tr>
<td>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#define</span> <span class="identifier">BOOST_TEST_MODULE</span> <span class="identifier">example</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">included</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">struct</span> <span class="identifier">F</span> <span class="special">{</span>
  <span class="identifier">F</span><span class="special">()</span> <span class="special">:</span> <span class="identifier">i</span><span class="special">(</span> <span class="number">0</span> <span class="special">)</span> <span class="special">{</span> <span class="identifier">BOOST_TEST_MESSAGE</span><span class="special">(</span> <span class="string">"setup fixture"</span> <span class="special">);</span> <span class="special">}</span>
  <span class="special">~</span><span class="identifier">F</span><span class="special">()</span>         <span class="special">{</span> <span class="identifier">BOOST_TEST_MESSAGE</span><span class="special">(</span> <span class="string">"teardown fixture"</span> <span class="special">);</span> <span class="special">}</span>

  <span class="keyword">int</span> <span class="identifier">i</span><span class="special">;</span>
<span class="special">};</span>

<span class="identifier">BOOST_FIXTURE_TEST_CASE</span><span class="special">(</span> <span class="identifier">test_case1</span><span class="special">,</span> <span class="identifier">F</span> <span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">BOOST_CHECK</span><span class="special">(</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">1</span> <span class="special">);</span>
  <span class="special">++</span><span class="identifier">i</span><span class="special">;</span>
<span class="special">}</span>

<span class="identifier">BOOST_FIXTURE_TEST_CASE</span><span class="special">(</span> <span class="identifier">test_case2</span><span class="special">,</span> <span class="identifier">F</span> <span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">BOOST_CHECK_EQUAL</span><span class="special">(</span> <span class="identifier">i</span><span class="special">,</span> <span class="number">1</span> <span class="special">);</span>
<span class="special">}</span>

<span class="identifier">BOOST_AUTO_TEST_CASE</span><span class="special">(</span> <span class="identifier">test_case3</span> <span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">BOOST_CHECK</span><span class="special">(</span> <span class="keyword">true</span> <span class="special">);</span>
<span class="special">}</span>
</pre>
                </td>
<td>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="special">&gt;</span> <span class="identifier">example</span> <span class="special">--</span><span class="identifier">log_level</span><span class="special">=</span><span class="identifier">message</span>
<span class="identifier">Running</span> <span class="number">3</span> <span class="identifier">test</span> <span class="identifier">cases</span><span class="special">...</span>
<span class="identifier">setup</span> <span class="identifier">fixture</span>
<span class="identifier">test</span><span class="special">.</span><span class="identifier">cpp</span><span class="special">(</span><span class="number">13</span><span class="special">):</span> <span class="identifier">error</span> <span class="identifier">in</span> <span class="string">"test_case1"</span><span class="special">:</span> <span class="identifier">check</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">1</span> <span class="identifier">failed</span>
<span class="identifier">teardown</span> <span class="identifier">fixture</span>
<span class="identifier">setup</span> <span class="identifier">fixture</span>
<span class="identifier">test</span><span class="special">.</span><span class="identifier">cpp</span><span class="special">(</span><span class="number">19</span><span class="special">):</span> <span class="identifier">error</span> <span class="identifier">in</span> <span class="string">"test_case2"</span><span class="special">:</span> <span class="identifier">check</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">1</span> <span class="identifier">failed</span> <span class="special">[</span><span class="number">0</span> <span class="special">!=</span> <span class="number">1</span><span class="special">]</span>
<span class="identifier">teardown</span> <span class="identifier">fixture</span>

<span class="special">***</span> <span class="number">2</span> <span class="identifier">failures</span> <span class="identifier">detected</span> <span class="identifier">in</span> <span class="identifier">test</span> <span class="identifier">suite</span> <span class="string">"example"</span>
</pre>
                </td>
</tr></tbody>
</table></div>
<p>
          In this example only <code class="computeroutput"><span class="identifier">test_case1</span></code>
          and <code class="computeroutput"><span class="identifier">test_case2</span></code> have fixture
          <code class="computeroutput"><span class="identifier">F</span></code> assigned. In the next
          section you going to see what can be done if all test cases in a test suite
          require the same fixture.
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_test.tests_organization.fixtures.test_suite_level_fixture"></a><a name="ref_fixture_test_suite"></a><a class="link" href="fixtures.html#boost_test.tests_organization.fixtures.test_suite_level_fixture" title="Test suite level fixture">Test
        suite level fixture</a>
</h4></div></div></div>
<p>
          If all test cases in a test require the same fixture (you can group test
          cases in the test suite based on a fixture required) you can make another
          step toward an automation of a test fixture assignment. To assign the same
          shared fixture for all test cases in a test suite, use the macro <a class="link" href="fixtures.html#ref_fixture_test_suite"><code class="computeroutput"><span class="identifier">BOOST_FIXTURE_TEST_SUITE</span></code></a>
          in place of the macro <a class="link" href="test_organization_test_suite.html#ref_BOOST_AUTO_TEST_SUITE"><code class="computeroutput"><span class="identifier">BOOST_AUTO_TEST_SUITE</span></code></a> for automated
          test suite creation and registration.
        </p>
<pre class="programlisting"><span class="identifier">BOOST_FIXTURE_TEST_SUITE</span><span class="special">(</span><span class="identifier">suite_name</span><span class="special">,</span> <span class="identifier">fixure_name</span><span class="special">);</span>
</pre>
<p>
          Once again the only difference from the macro <a class="link" href="test_organization_test_suite.html#ref_BOOST_AUTO_TEST_SUITE"><code class="computeroutput"><span class="identifier">BOOST_AUTO_TEST_SUITE</span></code></a> usage is
          the presence of an extra argument - the fixture name. And now, you not
          only have direct access to the public and protected members of the fixture,
          but also do not need to refer to the fixture name in test case definition.
          All test cases assigned the same fixture automatically.
        </p>
<div class="tip"><table border="0" summary="Tip">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="../../../../../../../doc/src/images/tip.png"></td>
<th align="left">Tip</th>
</tr>
<tr><td align="left" valign="top"><p>
            If necessary you can reset the fixture for a particular test case with
            the use of the macro <a class="link" href="fixtures.html#ref_fixture_test_case"><code class="computeroutput"><span class="identifier">BOOST_FIXTURE_TEST_CASE</span></code></a>.
          </p></td></tr>
</table></div>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            The fixture assignment is <span class="emphasis"><em>deep</em></span>. In other words unless
            reset by another <a class="link" href="fixtures.html#ref_fixture_test_suite"><code class="computeroutput"><span class="identifier">BOOST_FIXTURE_TEST_SUITE</span></code></a> or
            <a class="link" href="fixtures.html#ref_fixture_test_case"><code class="computeroutput"><span class="identifier">BOOST_FIXTURE_TEST_CASE</span></code></a>
            definition the same fixture is assigned to all test cases, including
            ones that belong to the sub test suites.
          </p></td></tr>
</table></div>
<h6>
<a name="boost_test.tests_organization.fixtures.test_suite_level_fixture.h0"></a>
          <span><a name="boost_test.tests_organization.fixtures.test_suite_level_fixture.example_descr"></a></span><a class="link" href="fixtures.html#boost_test.tests_organization.fixtures.test_suite_level_fixture.example_descr">Example:
          Test suite level fixture</a>
        </h6>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                  <p>
                    Code
                  </p>
                </th>
<th>
                  <p>
                    Output
                  </p>
                </th>
</tr></thead>
<tbody><tr>
<td>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#define</span> <span class="identifier">BOOST_TEST_MODULE</span> <span class="identifier">example</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">included</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">struct</span> <span class="identifier">F</span> <span class="special">{</span>
  <span class="identifier">F</span><span class="special">()</span> <span class="special">:</span> <span class="identifier">i</span><span class="special">(</span> <span class="number">0</span> <span class="special">)</span> <span class="special">{</span> <span class="identifier">BOOST_TEST_MESSAGE</span><span class="special">(</span> <span class="string">"setup fixture"</span> <span class="special">);</span> <span class="special">}</span>
  <span class="special">~</span><span class="identifier">F</span><span class="special">()</span>         <span class="special">{</span> <span class="identifier">BOOST_TEST_MESSAGE</span><span class="special">(</span> <span class="string">"teardown fixture"</span> <span class="special">);</span> <span class="special">}</span>

  <span class="keyword">int</span> <span class="identifier">i</span><span class="special">;</span>
<span class="special">};</span>

<span class="comment">//____________________________________________________________________________//</span>

<span class="identifier">BOOST_FIXTURE_TEST_SUITE</span><span class="special">(</span> <span class="identifier">s</span><span class="special">,</span> <span class="identifier">F</span> <span class="special">)</span>

<span class="identifier">BOOST_AUTO_TEST_CASE</span><span class="special">(</span> <span class="identifier">test_case1</span> <span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">BOOST_CHECK</span><span class="special">(</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">1</span> <span class="special">);</span>
<span class="special">}</span>

<span class="comment">//____________________________________________________________________________//</span>

<span class="identifier">BOOST_AUTO_TEST_CASE</span><span class="special">(</span> <span class="identifier">test_case2</span> <span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">BOOST_CHECK_EQUAL</span><span class="special">(</span> <span class="identifier">i</span><span class="special">,</span> <span class="number">0</span> <span class="special">);</span>
<span class="special">}</span>

<span class="comment">//____________________________________________________________________________//</span>

<span class="identifier">BOOST_AUTO_TEST_SUITE_END</span><span class="special">()</span>
</pre>
                </td>
<td>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="special">&gt;</span> <span class="identifier">example</span>
<span class="identifier">Running</span> <span class="number">2</span> <span class="identifier">test</span> <span class="identifier">cases</span><span class="special">...</span>
<span class="identifier">test</span><span class="special">.</span><span class="identifier">cpp</span><span class="special">(</span><span class="number">17</span><span class="special">):</span> <span class="identifier">error</span> <span class="identifier">in</span> <span class="string">"test_case1"</span><span class="special">:</span> <span class="identifier">check</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">1</span> <span class="identifier">failed</span>

<span class="special">***</span> <span class="number">1</span> <span class="identifier">failure</span> <span class="identifier">detected</span> <span class="identifier">in</span> <span class="identifier">test</span> <span class="identifier">suite</span> <span class="string">"example"</span>
</pre>
                </td>
</tr></tbody>
</table></div>
<div class="caution"><table border="0" summary="Caution">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="../../../../../../../doc/src/images/caution.png"></td>
<th align="left">Caution</th>
</tr>
<tr><td align="left" valign="top"><p>
            The fixture constructor and destructor is called for each test cases
            (the state of the fixture is not shared among the test cases).
          </p></td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_test.tests_organization.fixtures.global_fixture"></a><a name="ref_fixture_test_global"></a><a class="link" href="fixtures.html#boost_test.tests_organization.fixtures.global_fixture" title="Global fixture">Global
        fixture</a>
</h4></div></div></div>
<p>
          Any global initialization that needs to be performed every time testing
          begins or a global cleanup that is to be performed once testing is finished
          is called a global fixture. The <span class="emphasis"><em>Unit Test Framework</em></span>
          global fixture design is based on a generic test fixture model and is supported
          by the utility class <code class="computeroutput"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">unit_test</span><span class="special">::</span><span class="identifier">global_fixture</span></code>.
          The global fixture design allows any number of global fixtures to be defined
          in any test file that constitutes a test module. Though some initialization
          can be implemented in the test module initialization function, there are
          several reasons to prefer the global fixture approach:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
              There is no place for cleanup/teardown operations in the initialization
              function.
            </li>
<li class="listitem">
              Unlike the initialization function, the global fixture setup method
              invocation is guarded by the execution monitor. That means that all
              uncaught errors that occur during initialization are properly reported.
            </li>
<li class="listitem">
              Any number of different global fixtures can be defined, which allows
              you to split initialization code by category.
            </li>
<li class="listitem">
              The fixture allows you to place matching setup/teardown code in close
              vicinity in your test module code.
            </li>
<li class="listitem">
              If the whole test tree is constructed automatically the initialization
              function is empty and auto-generated by the <span class="emphasis"><em>Unit Test Framework</em></span>.
              To introduce the initialization function can be more work than the
              use of a global fixture facility, while global fixture is more to the
              point.
            </li>
<li class="listitem">
              Since all fixtures follow the same generic model you can easily switch
              from local per test case fixtures to the global one.
            </li>
<li class="listitem">
              If you are using the interactive test runner (non-supplied yet) global
              test fixtures are applied to every run, while an initialization function
              is executed only once during a test module startup (just make sure
              that it's what you really want).
            </li>
</ul></div>
<p>
          To define a global test module fixture you need to implement a class that
          matched generic fixture model and passed it as an argument to the macro
          <a class="link" href="fixtures.html#ref_fixture_test_global"><code class="computeroutput"><span class="identifier">BOOST_GLOBAL_FIXTURE</span></code></a>.
        </p>
<pre class="programlisting"><span class="identifier">BOOST_GLOBAL_FIXTURE</span><span class="special">(</span><span class="identifier">fixure_name</span><span class="special">);</span>
</pre>
<p>
          The statement, that performs global fixture definition, has to reside at
          a test file scope.
        </p>
<h6>
<a name="boost_test.tests_organization.fixtures.global_fixture.h0"></a>
          <span><a name="boost_test.tests_organization.fixtures.global_fixture.example_descr"></a></span><a class="link" href="fixtures.html#boost_test.tests_organization.fixtures.global_fixture.example_descr">Example:
          Global fixture</a>
        </h6>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                  <p>
                    Code
                  </p>
                </th>
<th>
                  <p>
                    Output
                  </p>
                </th>
</tr></thead>
<tbody><tr>
<td>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="preprocessor">#define</span> <span class="identifier">BOOST_TEST_MODULE</span> <span class="identifier">example</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">included</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">iostream</span><span class="special">&gt;</span>

<span class="comment">//____________________________________________________________________________//</span>

<span class="keyword">struct</span> <span class="identifier">MyConfig</span> <span class="special">{</span>
  <span class="identifier">MyConfig</span><span class="special">()</span>   <span class="special">{</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"global setup\n"</span><span class="special">;</span> <span class="special">}</span>
  <span class="special">~</span><span class="identifier">MyConfig</span><span class="special">()</span>  <span class="special">{</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"global teardown\n"</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>

<span class="comment">//____________________________________________________________________________//</span>

<span class="identifier">BOOST_GLOBAL_FIXTURE</span><span class="special">(</span> <span class="identifier">MyConfig</span> <span class="special">);</span>

<span class="identifier">BOOST_AUTO_TEST_CASE</span><span class="special">(</span> <span class="identifier">test_case</span> <span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">BOOST_CHECK</span><span class="special">(</span> <span class="keyword">true</span> <span class="special">);</span>
<span class="special">}</span>
</pre>
                </td>
<td>
<pre xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" class="table-programlisting"><span class="special">&gt;</span> <span class="identifier">example</span>
<span class="identifier">global</span> <span class="identifier">setup</span>
<span class="identifier">Running</span> <span class="number">1</span> <span class="identifier">test</span> <span class="keyword">case</span><span class="special">...</span>
<span class="identifier">global</span> <span class="identifier">teardown</span>

<span class="special">***</span> <span class="identifier">No</span> <span class="identifier">errors</span> <span class="identifier">detected</span>
</pre>
                </td>
</tr></tbody>
</table></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2001-2014 Gennadiy
      Rozental<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="test_organization_test_suite.html"><img src="../../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../tests_organization.html"><img src="../../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="../testing_tools.html"><img src="../../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
