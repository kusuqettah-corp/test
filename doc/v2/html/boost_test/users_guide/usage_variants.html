<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Linking with the Unit Test Framework</title>
<link rel="stylesheet" href="../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="../../index.html" title="Boost.Test">
<link rel="up" href="../users_guide.html" title="Building a test module with the Unit Test Framework">
<link rel="prev" href="module_initialization.html" title="Test module initialization">
<link rel="next" href="link_references.html" title="Macros that control the build behaviours">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="module_initialization.html"><img src="../../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../users_guide.html"><img src="../../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="link_references.html"><img src="../../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_test.users_guide.usage_variants"></a><a class="link" href="usage_variants.html" title="Linking with the Unit Test Framework">Linking with the
      <span class="emphasis"><em>Unit Test Framework</em></span></a>
</h3></div></div></div>
<p>
        The <span class="emphasis"><em>Unit Test Framework</em></span> supports four different usage
        variants:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            The static library variant
          </li>
<li class="listitem">
            The dynamic library variant
          </li>
<li class="listitem">
            The single-header variant
          </li>
<li class="listitem">
            The external test runner variant
          </li>
</ol></div>
<p>
        Unlike the Buridan's donkey though, you shouldn't have problems deciding
        which one to use, since there are clear reasons why would you prefer each
        one.
      </p>
<p>
        In most cases to compile a test module based on the <span class="emphasis"><em>Unit Test Framework</em></span>
        all you need to include is just the <code class="computeroutput"><a class="link" href="../../header/boost/test/unit_test_hpp.html" title="Header &lt;boost/test/unit_test.hpp&gt;">single
        header</a></code>
      </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
</pre>
<p>
        This header includes internally most of the other headers that contains the
        <span class="emphasis"><em>Unit Test Framework</em></span> definitions. Some advanced features,
        like the floating point comparison or the logged expectations testing, are
        defined in independent headers and need to be included explicitly.
      </p>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_test.users_guide.usage_variants.static_lib_variant"></a><a class="link" href="usage_variants.html#boost_test.users_guide.usage_variants.static_lib_variant" title="Static library variant">Static
        library variant</a>
</h4></div></div></div>
<p>
          The <span class="emphasis"><em>Unit Test Framework</em></span> can be built into a static
          library. If you opt to link a test module with the <span class="bold"><strong>standalone
          static library</strong></span>, this usage is called the static library variant
          of the <span class="emphasis"><em>Unit Test Framework</em></span>.
        </p>
<p>
          The test runner supplied with this variant required you to implement the
          <span class="bold"><strong>test module</strong></span> initialization function that
          matches one of the two specifications depending on the compilation flag
          <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_alternative_init_macro" title="BOOST_TEST_ALTERNATIVE_INIT_API"><code class="computeroutput"><span class="identifier">BOOST_TEST_ALTERNATIVE_INIT_API</span></code></a>.
          If flag isn't defined you are required to match the original specification.
          If you define the flag <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_alternative_init_macro" title="BOOST_TEST_ALTERNATIVE_INIT_API"><code class="computeroutput"><span class="identifier">BOOST_TEST_ALTERNATIVE_INIT_API</span></code></a>
          during a test module compilation you are required to use the alternative
          initialization function specification. The <span class="emphasis"><em>Unit Test Framework</em></span>
          provides an ability to <span class="bold"><strong>automatically generate</strong></span>
          an empty test module initialization function with correct specification
          if no custom initialization is required by a test module.
        </p>
<p>
          If you opted to use an alternative initialization API, for a test module
          to be able to link with prebuilt library, the flag <code class="computeroutput"><a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_alternative_init_macro" title="BOOST_TEST_ALTERNATIVE_INIT_API"><code class="computeroutput"><span class="identifier">BOOST_TEST_ALTERNATIVE_INIT_API</span></code></a></code>
          has to be defined both during library and a test module compilation.
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_test.users_guide.usage_variants.dynamic_lib_variant"></a><a class="link" href="usage_variants.html#boost_test.users_guide.usage_variants.dynamic_lib_variant" title="Dynamic library variant">Dynamic
        library variant</a>
</h4></div></div></div>
<p>
          In the project with large number of test modules <a class="link" href="usage_variants.html#boost_test.users_guide.usage_variants.static_lib_variant" title="Static library variant">the
          static library variant</a> of the <span class="emphasis"><em>Unit Test Framework</em></span>
          may cause you to waste a lot of disk space, since the <span class="emphasis"><em>Unit Test
          Framework</em></span> is linked statically with every test module. The solution
          is to link with the <span class="emphasis"><em>Unit Test Framework</em></span> built into
          a dynamic library (dynamic library variant of the <span class="emphasis"><em>Unit Test Framework</em></span>).
        </p>
<p>
          This variant requires you to define the flag <code class="computeroutput"><a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_dyn_link" title="BOOST_TEST_DYN_LINK"><code class="computeroutput"><span class="identifier">BOOST_TEST_DYN_LINK</span></code></a></code> either
          in a makefile or before the header <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span></code>
          inclusion.
        </p>
<p>
          The test runner supplied with this variant requires you to implement the
          <a class="link" href="../section_glossary.html#ref_test_module">test module</a> initialization function
          that matches the alternative initialization function signature. The <span class="emphasis"><em>Unit
          Test Framework</em></span> provides an ability to automatically generate
          an empty test module initialization function with correct signature if
          no custom initialization is required by a test module through the definition
          of the <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_main_macro" title="BOOST_TEST_MAIN"><code class="computeroutput"><span class="identifier">BOOST_TEST_MAIN</span></code></a> macro.
        </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../../../../../../doc/src/images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top"><p>
            <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_dyn_link" title="BOOST_TEST_DYN_LINK"><code class="computeroutput"><span class="identifier">BOOST_TEST_DYN_LINK</span></code></a> may be defined
            if the macro <code class="computeroutput"><span class="identifier">BOOST_ALL_DYN_LINK</span></code>
            is defined
          </p></td></tr>
</table></div>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../../../../../../doc/src/images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top"><p>
            In order to be able to run a test built with the dynamic variant, the
            operating system should be able to find the dynamic library of the <span class="emphasis"><em>Unit
            Test Framework</em></span>. This means, for example on Linux and MacOSX
            respectively, setting the environment variable <code class="computeroutput"><span class="identifier">LD_LIBRARY_PATH</span></code>
            or <code class="computeroutput"><span class="identifier">DYLD_LIBRARY_PATH</span></code>
            properly prior to the execution of the test module.
          </p></td></tr>
</table></div>
<div class="section">
<div class="titlepage"><div><div><h5 class="title">
<a name="boost_test.users_guide.usage_variants.dynamic_lib_variant.dynamic_lib_variant_minimal_example"></a><a class="link" href="usage_variants.html#boost_test.users_guide.usage_variants.dynamic_lib_variant.dynamic_lib_variant_minimal_example" title="Minimal example">Minimal
          example</a>
</h5></div></div></div>
<p>
            A trivial example of dynamic variant of the <span class="emphasis"><em>Unit Test Framework</em></span>
            would be the following:
          </p>
<pre class="programlisting"><span class="preprocessor">#define</span> <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_dyn_link" title="BOOST_TEST_DYN_LINK"><code class="computeroutput"><span class="identifier">BOOST_TEST_DYN_LINK</span></code></a>
<span class="preprocessor">#define</span> <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_main_macro" title="BOOST_TEST_MAIN"><code class="computeroutput"><span class="identifier">BOOST_TEST_MAIN</span></code></a>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="identifier">BOOST_AUTO_TEST_CASE</span><span class="special">(</span><span class="identifier">my_test</span><span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">BOOST_CHECK</span><span class="special">(</span><span class="keyword">true</span><span class="special">);</span>
<span class="special">}</span>
</pre>
<p>
            Behind the scenes:
          </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
                <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_dyn_link" title="BOOST_TEST_DYN_LINK"><code class="computeroutput"><span class="identifier">BOOST_TEST_DYN_LINK</span></code></a> tells
                the compiler/linker to dynamically link against the <span class="emphasis"><em>Unit
                Test Framework</em></span>
              </li>
<li class="listitem">
                <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_main_macro" title="BOOST_TEST_MAIN"><code class="computeroutput"><span class="identifier">BOOST_TEST_MAIN</span></code></a> generates
                a <code class="computeroutput"><span class="identifier">main</span></code> entry point
                to the test module executable, as well as a generic test registration
                function, which registers all tests declared with the macros <a class="link" href="../tests_organization/test_cases.html#ref_BOOST_AUTO_TEST_CASE"><code class="computeroutput"><span class="identifier">BOOST_AUTO_TEST_CASE</span></code></a>,
                <a class="link" href="../tests_organization/fixtures.html#ref_fixture_test_case"><code class="computeroutput"><span class="identifier">BOOST_FIXTURE_TEST_CASE</span></code></a>,
                <a class="link" href="../tests_organization/test_cases.html#ref_BOOST_AUTO_TEST_CASE_TEMPLATE"><code class="computeroutput"><span class="identifier">BOOST_AUTO_TEST_CASE_TEMPLATE</span></code></a>
                or <a class="link" href="../tests_organization/test_cases.html#ref_BOOST_PARAM_TEST_CASE"><code class="computeroutput"><span class="identifier">BOOST_PARAM_TEST_CASE</span></code></a>
                .
              </li>
</ul></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h5 class="title">
<a name="boost_test.users_guide.usage_variants.dynamic_lib_variant.dynamic_lib_variant_multiple_source_files"></a><a class="link" href="usage_variants.html#boost_test.users_guide.usage_variants.dynamic_lib_variant.dynamic_lib_variant_multiple_source_files" title="Multiple source files">Multiple
          source files</a>
</h5></div></div></div>
<p>
            The macro <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_main_macro" title="BOOST_TEST_MAIN"><code class="computeroutput"><span class="identifier">BOOST_TEST_MAIN</span></code></a> defines a <code class="computeroutput"><span class="identifier">main</span></code> function and an automated registration
            of the tests. If the test module contains several files, only one <code class="computeroutput"><span class="identifier">main</span></code> and one registration function
            should be defined, which also means that <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_main_macro" title="BOOST_TEST_MAIN"><code class="computeroutput"><span class="identifier">BOOST_TEST_MAIN</span></code></a> should be defined
            in one compilation unit only.
          </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h5 class="title">
<a name="boost_test.users_guide.usage_variants.dynamic_lib_variant.dynamic_lib_variant_manual_registration"></a><a class="link" href="usage_variants.html#boost_test.users_guide.usage_variants.dynamic_lib_variant.dynamic_lib_variant_manual_registration" title="Manual test registration">Manual
          test registration</a>
</h5></div></div></div>
<p>
            The automatic generation of the test module works well with auto-registrated
            tests (explained in detail <a class="link" href="../tests_organization/test_cases.html" title="Test cases">here</a>),
            but needs some tweaking for tests registered manually.
          </p>
<p>
            In that case, <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_no_main" title="BOOST_TEST_NO_MAIN"><code class="computeroutput"><span class="identifier">BOOST_TEST_NO_MAIN</span></code></a> may be defined
            in order to prevent the generation of the test module initialisation.
          </p>
<div class="tip"><table border="0" summary="Tip">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="../../../../../../../doc/src/images/tip.png"></td>
<th align="left">Tip</th>
</tr>
<tr><td align="left" valign="top"><p>
              Another advantage of defining <a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_no_main" title="BOOST_TEST_NO_MAIN"><code class="computeroutput"><span class="identifier">BOOST_TEST_NO_MAIN</span></code></a> is that
              the code for the test module initialisation would then be independant
              against the static/dynamic variant of the <span class="emphasis"><em>Unit Test Framework</em></span>
            </p></td></tr>
</table></div>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
              The name of the test module initialization function is not enforced,
              since the function is passed as an argument to the test runner.
            </p></td></tr>
</table></div>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_test.users_guide.usage_variants.single_header_variant"></a><a class="link" href="usage_variants.html#boost_test.users_guide.usage_variants.single_header_variant" title="The single-header variant of the Unit Test Framework">The
        single-header variant of the <span class="emphasis"><em>Unit Test Framework</em></span></a>
</h4></div></div></div>
<p>
          If you prefer to avoid the <span class="bold"><strong>standalone library compilation</strong></span>,
          you should use the single-header variant of the <span class="emphasis"><em>Unit Test Framework</em></span>.
          This variant is implemented, as it follows from its name, in the single
          header
        </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">included</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
</pre>
<p>
          An inclusion of the header causes the complete implementation of the <span class="emphasis"><em>Unit
          Test Framework</em></span> to be included as a part of a test module's source
          file. The header
        </p>
<pre class="programlisting"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span></pre>
<p>
          doesn't have to be included anymore. You don't have to worry about disabling
          <span class="bold"><strong>auto-linking</strong></span> feature either. It's done
          in the implementation header already. This variant can't be used with the
          <span class="bold"><strong>multi-file test module</strong></span>. Otherwise it's
          almost identical from the usage prospective to the static library variant
          of the <span class="emphasis"><em>Unit Test Framework</em></span>. In fact the only difference
          is the name of the include file:
        </p>
<pre class="programlisting"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">included</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span></pre>
<p>
          instead of
        </p>
<pre class="programlisting"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span></pre>
<p>
          .
        </p>
<p>
          The test runner supplied with this variant requires you to implement the
          <a class="link" href="../section_glossary.html#ref_test_module">test module</a> initialization function
          that matches one of the two specifications depending on the compilation
          flag <code class="computeroutput"><a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_alternative_init_macro" title="BOOST_TEST_ALTERNATIVE_INIT_API"><code class="computeroutput"><span class="identifier">BOOST_TEST_ALTERNATIVE_INIT_API</span></code></a></code>.
          If flag isn't defined you are required to match the original specification.
          If you define the flag <code class="computeroutput"><a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_alternative_init_macro" title="BOOST_TEST_ALTERNATIVE_INIT_API"><code class="computeroutput"><span class="identifier">BOOST_TEST_ALTERNATIVE_INIT_API</span></code></a></code>
          during a test module compilation you are required to use the alternative
          initialization function specification. The <span class="emphasis"><em>Unit Test Framework</em></span>
          provides an ability to <span class="bold"><strong>automatically generate</strong></span>
          an empty test module initialization function with correct specification
          if no custom initialization is required by a test module.
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_test.users_guide.usage_variants.extern_test_runner_variant"></a><a class="link" href="usage_variants.html#boost_test.users_guide.usage_variants.extern_test_runner_variant" title="The external test runner variant of the Unit Test Framework">The
        external test runner variant of the <span class="emphasis"><em>Unit Test Framework</em></span></a>
</h4></div></div></div>
<p>
          All other usage variants employ the build-in test runners. If you plan
          to use an external test runner with your test module you need to build
          it as a dynamic library. This usage of the <span class="emphasis"><em>Unit Test Framework</em></span>
          is called the external test runner variant of the <span class="emphasis"><em>Unit Test Framework</em></span>.
          The variant requires you to define the flag <code class="computeroutput"><a class="link" href="link_references.html#boost_test.users_guide.link_references.link_boost_test_dyn_link" title="BOOST_TEST_DYN_LINK"><code class="computeroutput"><span class="identifier">BOOST_TEST_DYN_LINK</span></code></a></code> either
          in a makefile or before the header <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">test</span><span class="special">/</span><span class="identifier">unit_test</span><span class="special">.</span><span class="identifier">hpp</span></code>
          inclusion. An external test runner utility is required to link with dynamic
          library.
        </p>
<p>
          If an external test runner is based on the test runner built in to the
          dynamic library (like the standalone boost_test_runner utility supplied
          by the <span class="emphasis"><em>Unit Test Framework</em></span>), it requires you to implement
          the <a class="link" href="../section_glossary.html#ref_test_module">test module</a> initialization function
          that matches the alternative initialization function signature. The <span class="emphasis"><em>Unit
          Test Framework</em></span> provides an ability to <span class="bold"><strong>automatically
          generate</strong></span> an empty test module initialization function with correct
          signature if no custom initialization is required by a test module.
        </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            An advanced test runner doesn't have to be based on the build-in one
            and may require a different test module initialization function signature
            and/or name.
          </p></td></tr>
</table></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2001-2014 Gennadiy
      Rozental<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="module_initialization.html"><img src="../../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../users_guide.html"><img src="../../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="link_references.html"><img src="../../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
